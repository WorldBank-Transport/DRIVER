---
- name: Create static files directory
  file: path={{ root_static_dir }}
        owner={{ driver_user }}
        group={{ driver_user }}
        mode=0775
        state=directory

- name: Create media files directory
  file: path={{ root_media_dir }}
        owner={{ driver_user }}
        group={{ driver_user }}
        mode=0775
        state=directory

- name: Configure Driver application service definition
  template: src=upstart-default.j2 dest=/etc/init/driver-app.conf
  notify:
    - Restart driver-app

- name: Configure Driver application Nginx service definition
  template: src=nginx-default.j2 dest=/etc/nginx/conf.d/driver-app.conf
  notify:
    - Restart Nginx

#- name: Run django collectstatic
  #django_manage: command=collectstatic app_path={{ root_app_dir }}

#- name: Run django migrations
  #django_manage: command=migrate app_path={{ root_app_dir }}

#- name: Add OAuth2 default application (development only)
  #django_manage: command="create_oauth_app admin" app_path={{ root_app_dir }}
  #when: developing_or_testing
